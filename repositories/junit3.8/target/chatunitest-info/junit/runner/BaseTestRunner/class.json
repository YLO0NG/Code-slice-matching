{
  "fullClassName": "junit.runner.BaseTestRunner",
  "className": "BaseTestRunner",
  "index": 19,
  "modifier": "[public , abstract ]",
  "extend": "[]",
  "implement": "[TestListener]",
  "packageName": "junit.runner",
  "packageDeclaration": "package junit.runner;",
  "classSignature": "public abstract class BaseTestRunner",
  "hasConstructor": false,
  "isPublic": true,
  "isInterface": false,
  "isAbstract": true,
  "imports": [
    "import junit.framework.*;",
    "import java.lang.reflect.*;",
    "import java.text.NumberFormat;",
    "import java.io.*;",
    "import java.util.*;"
  ],
  "fields": [
    "public static final String SUITE_METHODNAME= \"suite\";",
    "private static Properties fPreferences;",
    "static int fgMaxMessageLength= 500;",
    "static boolean fgFilterStack= true;",
    "boolean fLoading= true;"
  ],
  "superClasses": [],
  "implementedTypes": [
    "TestListener"
  ],
  "methodSigs": {
    "startTest(Test)": "0",
    "setPreferences(Properties)": "1",
    "getPreferences()": "2",
    "savePreferences()": "3",
    "setPreference(String, String)": "4",
    "endTest(Test)": "5",
    "addError(Test, Throwable)": "6",
    "addFailure(Test, AssertionFailedError)": "7",
    "testStarted(String)": "8",
    "testEnded(String)": "9",
    "testFailed(int, Test, Throwable)": "10",
    "getTest(String)": "11",
    "elapsedTimeAsString(long)": "12",
    "processArguments(String[])": "13",
    "setLoading(boolean)": "14",
    "extractClassName(String)": "15",
    "truncate(String)": "16",
    "runFailed(String)": "17",
    "loadSuiteClass(String)": "18",
    "clearStatus()": "19",
    "getLoader()": "20",
    "useReloadingTestSuiteLoader()": "21",
    "getPreferencesFile()": "22",
    "readPreferences()": "23",
    "getPreference(String)": "24",
    "getPreference(String, int)": "25",
    "inVAJava()": "26",
    "getFilteredTrace(Throwable)": "27",
    "getFilteredTrace(String)": "28",
    "showStackRaw()": "29",
    "filterLine(String)": "30"
  },
  "methodsBrief": [
    "public synchronized void startTest(Test test){}",
    "protected static void setPreferences(Properties preferences){}",
    "protected static Properties getPreferences(){}",
    "public static void savePreferences() throws IOException{}",
    "public void setPreference(String key, String value){}",
    "public synchronized void endTest(Test test){}",
    "public synchronized void addError(final Test test, final Throwable t){}",
    "public synchronized void addFailure(final Test test, final AssertionFailedError t){}",
    "public abstract void testStarted(String testName);",
    "public abstract void testEnded(String testName);",
    "public abstract void testFailed(int status, Test test, Throwable t);",
    "public Test getTest(String suiteClassName){}",
    "public String elapsedTimeAsString(long runTime){}",
    "protected String processArguments(String[] args){}",
    "public void setLoading(boolean enable){}",
    "public String extractClassName(String className){}",
    "public static String truncate(String s){}",
    "protected abstract void runFailed(String message);",
    "protected Class loadSuiteClass(String suiteClassName) throws ClassNotFoundException{}",
    "protected void clearStatus(){}",
    "public TestSuiteLoader getLoader(){}",
    "protected boolean useReloadingTestSuiteLoader(){}",
    "private static File getPreferencesFile(){}",
    "private static void readPreferences(){}",
    "public static String getPreference(String key){}",
    "public static int getPreference(String key, int dflt){}",
    "public static boolean inVAJava(){}",
    "public static String getFilteredTrace(Throwable t){}",
    "public static String getFilteredTrace(String stack){}",
    "protected static boolean showStackRaw(){}",
    "static boolean filterLine(String line){}"
  ],
  "constructorSigs": [],
  "constructorBrief": [],
  "getterSetterSigs": [
    "setPreferences(Properties)",
    "getPreferences()",
    "setPreference(String, String)",
    "setLoading(boolean)",
    "getLoader()",
    "getPreferencesFile()"
  ],
  "getterSetterBrief": [
    "protected static void setPreferences(Properties preferences){}",
    "protected static Properties getPreferences(){}",
    "public void setPreference(String key, String value){}",
    "public void setLoading(boolean enable){}",
    "public TestSuiteLoader getLoader(){}",
    "private static File getPreferencesFile(){}"
  ],
  "constructorDeps": {},
  "compilationUnitCode": "package junit.runner;\r\n\r\nimport junit.framework.*;\r\nimport java.lang.reflect.*;\r\nimport java.text.NumberFormat;\r\nimport java.io.*;\r\nimport java.util.*;\r\n\r\n/**\r\n * Base class for all test runners.\r\n * This class was born live on stage in Sardinia during XP2000.\r\n */\r\npublic abstract class BaseTestRunner implements TestListener {\r\n\r\n    public static final String SUITE_METHODNAME = \"suite\";\r\n\r\n    private static Properties fPreferences;\r\n\r\n    static int fgMaxMessageLength = 500;\r\n\r\n    static boolean fgFilterStack = true;\r\n\r\n    boolean fLoading = true;\r\n\r\n    /*\r\n    * Implementation of TestListener\r\n    */\r\n    public synchronized void startTest(Test test) {\r\n        testStarted(test.toString());\r\n    }\r\n\r\n    protected static void setPreferences(Properties preferences) {\r\n        fPreferences = preferences;\r\n    }\r\n\r\n    protected static Properties getPreferences() {\r\n        if (fPreferences == null) {\r\n            fPreferences = new Properties();\r\n            fPreferences.put(\"loading\", \"true\");\r\n            fPreferences.put(\"filterstack\", \"true\");\r\n            /*{*/\r\n            InputStream is = null;\r\n            try {\r\n                is = new FileInputStream(getPreferencesFile());\r\n                setPreferences(new Properties(getPreferences()));\r\n                getPreferences().load(is);\r\n            } catch (IOException e) {\r\n                try {\r\n                    if (is != null)\r\n                        is.close();\r\n                } catch (IOException e1) {\r\n                }\r\n            }\r\n            /*}*/\r\n        }\r\n        return fPreferences;\r\n    }\r\n\r\n    public static void savePreferences() throws IOException {\r\n        FileOutputStream fos = new FileOutputStream(getPreferencesFile());\r\n        try {\r\n            getPreferences().store(fos, \"\");\r\n        } finally {\r\n            fos.close();\r\n        }\r\n    }\r\n\r\n    public void setPreference(String key, String value) {\r\n        getPreferences().setProperty(key, value);\r\n    }\r\n\r\n    public synchronized void endTest(Test test) {\r\n        testEnded(test.toString());\r\n    }\r\n\r\n    public synchronized void addError(final Test test, final Throwable t) {\r\n        testFailed(TestRunListener.STATUS_ERROR, test, t);\r\n    }\r\n\r\n    public synchronized void addFailure(final Test test, final AssertionFailedError t) {\r\n        testFailed(TestRunListener.STATUS_FAILURE, test, t);\r\n    }\r\n\r\n    // TestRunListener implementation\r\n    public abstract void testStarted(String testName);\r\n\r\n    public abstract void testEnded(String testName);\r\n\r\n    public abstract void testFailed(int status, Test test, Throwable t);\r\n\r\n    /**\r\n     * Returns the Test corresponding to the given suite. This is\r\n     * a template method, subclasses override runFailed(), clearStatus().\r\n     */\r\n    public Test getTest(String suiteClassName) {\r\n        if (suiteClassName.length() <= 0) {\r\n            clearStatus();\r\n            return null;\r\n        }\r\n        Class testClass = null;\r\n        try {\r\n            testClass = loadSuiteClass(suiteClassName);\r\n        } catch (ClassNotFoundException e) {\r\n            String clazz = e.getMessage();\r\n            if (clazz == null)\r\n                clazz = suiteClassName;\r\n            runFailed(\"Class not found \\\"\" + clazz + \"\\\"\");\r\n            return null;\r\n        } catch (Exception e) {\r\n            runFailed(\"Error: \" + e.toString());\r\n            return null;\r\n        }\r\n        Method suiteMethod = null;\r\n        try {\r\n            suiteMethod = testClass.getMethod(SUITE_METHODNAME, new Class[0]);\r\n        } catch (Exception e) {\r\n            // try to extract a test suite automatically\r\n            clearStatus();\r\n            return new TestSuite(testClass);\r\n        }\r\n        if (!Modifier.isStatic(suiteMethod.getModifiers())) {\r\n            runFailed(\"Suite() method must be static\");\r\n            return null;\r\n        }\r\n        Test test = null;\r\n        try {\r\n            // static method\r\n            test = (Test) suiteMethod.invoke(null, new Class[0]);\r\n            if (test == null)\r\n                return test;\r\n        } catch (InvocationTargetException e) {\r\n            runFailed(\"Failed to invoke suite():\" + e.getTargetException().toString());\r\n            return null;\r\n        } catch (IllegalAccessException e) {\r\n            runFailed(\"Failed to invoke suite():\" + e.toString());\r\n            return null;\r\n        }\r\n        clearStatus();\r\n        return test;\r\n    }\r\n\r\n    /**\r\n     * Returns the formatted string of the elapsed time.\r\n     */\r\n    public String elapsedTimeAsString(long runTime) {\r\n        return NumberFormat.getInstance().format((double) runTime / 1000);\r\n    }\r\n\r\n    /**\r\n     * Processes the command line arguments and\r\n     * returns the name of the suite class to run or null\r\n     */\r\n    protected String processArguments(String[] args) {\r\n        String suiteName = null;\r\n        for (int i = 0; i < args.length; i++) {\r\n            if (args[i].equals(\"-noloading\")) {\r\n                setLoading(false);\r\n            } else if (args[i].equals(\"-nofilterstack\")) {\r\n                fgFilterStack = false;\r\n            } else if (args[i].equals(\"-c\")) {\r\n                if (args.length > i + 1)\r\n                    suiteName = extractClassName(args[i + 1]);\r\n                else\r\n                    System.out.println(\"Missing Test class name\");\r\n                i++;\r\n            } else {\r\n                suiteName = args[i];\r\n            }\r\n        }\r\n        return suiteName;\r\n    }\r\n\r\n    /**\r\n     * Sets the loading behaviour of the test runner\r\n     */\r\n    public void setLoading(boolean enable) {\r\n        fLoading = enable;\r\n    }\r\n\r\n    /**\r\n     * Extract the class name from a String in VA/Java style\r\n     */\r\n    public String extractClassName(String className) {\r\n        if (className.startsWith(\"Default package for\"))\r\n            return className.substring(className.lastIndexOf(\".\") + 1);\r\n        return className;\r\n    }\r\n\r\n    /**\r\n     * Truncates a String to the maximum length.\r\n     */\r\n    public static String truncate(String s) {\r\n        if (fgMaxMessageLength != -1 && s.length() > fgMaxMessageLength)\r\n            s = s.substring(0, fgMaxMessageLength) + \"...\";\r\n        return s;\r\n    }\r\n\r\n    /**\r\n     * Override to define how to handle a failed loading of\r\n     * a test suite.\r\n     */\r\n    protected abstract void runFailed(String message);\r\n\r\n    /**\r\n     * Returns the loaded Class for a suite name.\r\n     */\r\n    protected Class loadSuiteClass(String suiteClassName) throws ClassNotFoundException {\r\n        return getLoader().load(suiteClassName);\r\n    }\r\n\r\n    /**\r\n     * Clears the status message.\r\n     */\r\n    protected void clearStatus() {\r\n        // Belongs in the GUI TestRunner class\r\n    }\r\n\r\n    /**\r\n     * Returns the loader to be used.\r\n     */\r\n    public TestSuiteLoader getLoader() {\r\n        if (useReloadingTestSuiteLoader())\r\n            return new ReloadingTestSuiteLoader();\r\n        return new StandardTestSuiteLoader();\r\n    }\r\n\r\n    protected boolean useReloadingTestSuiteLoader() {\r\n        return getPreference(\"loading\").equals(\"true\") && !inVAJava() && fLoading;\r\n    }\r\n\r\n    private static File getPreferencesFile() {\r\n        String home = System.getProperty(\"user.home\");\r\n        return new File(home, \"junit.properties\");\r\n    }\r\n\r\n    private static void readPreferences() {\r\n        InputStream is = null;\r\n        try {\r\n            is = new FileInputStream(getPreferencesFile());\r\n            setPreferences(new Properties(getPreferences()));\r\n            getPreferences().load(is);\r\n        } catch (IOException e) {\r\n            try {\r\n                if (is != null)\r\n                    is.close();\r\n            } catch (IOException e1) {\r\n            }\r\n        }\r\n    }\r\n\r\n    public static String getPreference(String key) {\r\n        return getPreferences().getProperty(key);\r\n    }\r\n\r\n    public static int getPreference(String key, int dflt) {\r\n        String value = getPreference(key);\r\n        int intValue = dflt;\r\n        if (value == null)\r\n            return intValue;\r\n        try {\r\n            intValue = Integer.parseInt(value);\r\n        } catch (NumberFormatException ne) {\r\n        }\r\n        return intValue;\r\n    }\r\n\r\n    public static boolean inVAJava() {\r\n        try {\r\n            Class.forName(\"com.ibm.uvm.tools.DebugSupport\");\r\n        } catch (Exception e) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Returns a filtered stack trace\r\n     */\r\n    public static String getFilteredTrace(Throwable t) {\r\n        StringWriter stringWriter = new StringWriter();\r\n        PrintWriter writer = new PrintWriter(stringWriter);\r\n        t.printStackTrace(writer);\r\n        StringBuffer buffer = stringWriter.getBuffer();\r\n        String trace = buffer.toString();\r\n        return BaseTestRunner.getFilteredTrace(trace);\r\n    }\r\n\r\n    /**\r\n     * Filters stack frames from internal JUnit classes\r\n     */\r\n    public static String getFilteredTrace(String stack) {\r\n        if (showStackRaw())\r\n            return stack;\r\n        StringWriter sw = new StringWriter();\r\n        PrintWriter pw = new PrintWriter(sw);\r\n        StringReader sr = new StringReader(stack);\r\n        BufferedReader br = new BufferedReader(sr);\r\n        String line;\r\n        try {\r\n            while ((line = br.readLine()) != null) {\r\n                if (!filterLine(line))\r\n                    pw.println(line);\r\n            }\r\n        } catch (Exception IOException) {\r\n            // return the stack unfiltered\r\n            return stack;\r\n        }\r\n        return sw.toString();\r\n    }\r\n\r\n    protected static boolean showStackRaw() {\r\n        return !getPreference(\"filterstack\").equals(\"true\") || fgFilterStack == false;\r\n    }\r\n\r\n    static boolean filterLine(String line) {\r\n        String[] patterns = new String[] { \"junit.framework.TestCase\", \"junit.framework.TestResult\", \"junit.framework.TestSuite\", // don't filter AssertionFailure\r\n        \"junit.framework.Assert.\", \"junit.swingui.TestRunner\", \"junit.awtui.TestRunner\", \"junit.textui.TestRunner\", \"java.lang.reflect.Method.invoke(\" };\r\n        for (int i = 0; i < patterns.length; i++) {\r\n            if (line.indexOf(patterns[i]) > 0)\r\n                return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    static {\r\n        fgMaxMessageLength = getPreference(\"maxmessage\", fgMaxMessageLength);\r\n    }\r\n}\r\n",
  "classDeclarationCode": "/**\r\n * Base class for all test runners.\r\n * This class was born live on stage in Sardinia during XP2000.\r\n */\r\npublic abstract class BaseTestRunner implements TestListener {\r\n\r\n    public static final String SUITE_METHODNAME = \"suite\";\r\n\r\n    private static Properties fPreferences;\r\n\r\n    static int fgMaxMessageLength = 500;\r\n\r\n    static boolean fgFilterStack = true;\r\n\r\n    boolean fLoading = true;\r\n\r\n    /*\r\n    * Implementation of TestListener\r\n    */\r\n    public synchronized void startTest(Test test) {\r\n        testStarted(test.toString());\r\n    }\r\n\r\n    protected static void setPreferences(Properties preferences) {\r\n        fPreferences = preferences;\r\n    }\r\n\r\n    protected static Properties getPreferences() {\r\n        if (fPreferences == null) {\r\n            fPreferences = new Properties();\r\n            fPreferences.put(\"loading\", \"true\");\r\n            fPreferences.put(\"filterstack\", \"true\");\r\n            /*{*/\r\n            InputStream is = null;\r\n            try {\r\n                is = new FileInputStream(getPreferencesFile());\r\n                setPreferences(new Properties(getPreferences()));\r\n                getPreferences().load(is);\r\n            } catch (IOException e) {\r\n                try {\r\n                    if (is != null)\r\n                        is.close();\r\n                } catch (IOException e1) {\r\n                }\r\n            }\r\n            /*}*/\r\n        }\r\n        return fPreferences;\r\n    }\r\n\r\n    public static void savePreferences() throws IOException {\r\n        FileOutputStream fos = new FileOutputStream(getPreferencesFile());\r\n        try {\r\n            getPreferences().store(fos, \"\");\r\n        } finally {\r\n            fos.close();\r\n        }\r\n    }\r\n\r\n    public void setPreference(String key, String value) {\r\n        getPreferences().setProperty(key, value);\r\n    }\r\n\r\n    public synchronized void endTest(Test test) {\r\n        testEnded(test.toString());\r\n    }\r\n\r\n    public synchronized void addError(final Test test, final Throwable t) {\r\n        testFailed(TestRunListener.STATUS_ERROR, test, t);\r\n    }\r\n\r\n    public synchronized void addFailure(final Test test, final AssertionFailedError t) {\r\n        testFailed(TestRunListener.STATUS_FAILURE, test, t);\r\n    }\r\n\r\n    // TestRunListener implementation\r\n    public abstract void testStarted(String testName);\r\n\r\n    public abstract void testEnded(String testName);\r\n\r\n    public abstract void testFailed(int status, Test test, Throwable t);\r\n\r\n    /**\r\n     * Returns the Test corresponding to the given suite. This is\r\n     * a template method, subclasses override runFailed(), clearStatus().\r\n     */\r\n    public Test getTest(String suiteClassName) {\r\n        if (suiteClassName.length() <= 0) {\r\n            clearStatus();\r\n            return null;\r\n        }\r\n        Class testClass = null;\r\n        try {\r\n            testClass = loadSuiteClass(suiteClassName);\r\n        } catch (ClassNotFoundException e) {\r\n            String clazz = e.getMessage();\r\n            if (clazz == null)\r\n                clazz = suiteClassName;\r\n            runFailed(\"Class not found \\\"\" + clazz + \"\\\"\");\r\n            return null;\r\n        } catch (Exception e) {\r\n            runFailed(\"Error: \" + e.toString());\r\n            return null;\r\n        }\r\n        Method suiteMethod = null;\r\n        try {\r\n            suiteMethod = testClass.getMethod(SUITE_METHODNAME, new Class[0]);\r\n        } catch (Exception e) {\r\n            // try to extract a test suite automatically\r\n            clearStatus();\r\n            return new TestSuite(testClass);\r\n        }\r\n        if (!Modifier.isStatic(suiteMethod.getModifiers())) {\r\n            runFailed(\"Suite() method must be static\");\r\n            return null;\r\n        }\r\n        Test test = null;\r\n        try {\r\n            // static method\r\n            test = (Test) suiteMethod.invoke(null, new Class[0]);\r\n            if (test == null)\r\n                return test;\r\n        } catch (InvocationTargetException e) {\r\n            runFailed(\"Failed to invoke suite():\" + e.getTargetException().toString());\r\n            return null;\r\n        } catch (IllegalAccessException e) {\r\n            runFailed(\"Failed to invoke suite():\" + e.toString());\r\n            return null;\r\n        }\r\n        clearStatus();\r\n        return test;\r\n    }\r\n\r\n    /**\r\n     * Returns the formatted string of the elapsed time.\r\n     */\r\n    public String elapsedTimeAsString(long runTime) {\r\n        return NumberFormat.getInstance().format((double) runTime / 1000);\r\n    }\r\n\r\n    /**\r\n     * Processes the command line arguments and\r\n     * returns the name of the suite class to run or null\r\n     */\r\n    protected String processArguments(String[] args) {\r\n        String suiteName = null;\r\n        for (int i = 0; i < args.length; i++) {\r\n            if (args[i].equals(\"-noloading\")) {\r\n                setLoading(false);\r\n            } else if (args[i].equals(\"-nofilterstack\")) {\r\n                fgFilterStack = false;\r\n            } else if (args[i].equals(\"-c\")) {\r\n                if (args.length > i + 1)\r\n                    suiteName = extractClassName(args[i + 1]);\r\n                else\r\n                    System.out.println(\"Missing Test class name\");\r\n                i++;\r\n            } else {\r\n                suiteName = args[i];\r\n            }\r\n        }\r\n        return suiteName;\r\n    }\r\n\r\n    /**\r\n     * Sets the loading behaviour of the test runner\r\n     */\r\n    public void setLoading(boolean enable) {\r\n        fLoading = enable;\r\n    }\r\n\r\n    /**\r\n     * Extract the class name from a String in VA/Java style\r\n     */\r\n    public String extractClassName(String className) {\r\n        if (className.startsWith(\"Default package for\"))\r\n            return className.substring(className.lastIndexOf(\".\") + 1);\r\n        return className;\r\n    }\r\n\r\n    /**\r\n     * Truncates a String to the maximum length.\r\n     */\r\n    public static String truncate(String s) {\r\n        if (fgMaxMessageLength != -1 && s.length() > fgMaxMessageLength)\r\n            s = s.substring(0, fgMaxMessageLength) + \"...\";\r\n        return s;\r\n    }\r\n\r\n    /**\r\n     * Override to define how to handle a failed loading of\r\n     * a test suite.\r\n     */\r\n    protected abstract void runFailed(String message);\r\n\r\n    /**\r\n     * Returns the loaded Class for a suite name.\r\n     */\r\n    protected Class loadSuiteClass(String suiteClassName) throws ClassNotFoundException {\r\n        return getLoader().load(suiteClassName);\r\n    }\r\n\r\n    /**\r\n     * Clears the status message.\r\n     */\r\n    protected void clearStatus() {\r\n        // Belongs in the GUI TestRunner class\r\n    }\r\n\r\n    /**\r\n     * Returns the loader to be used.\r\n     */\r\n    public TestSuiteLoader getLoader() {\r\n        if (useReloadingTestSuiteLoader())\r\n            return new ReloadingTestSuiteLoader();\r\n        return new StandardTestSuiteLoader();\r\n    }\r\n\r\n    protected boolean useReloadingTestSuiteLoader() {\r\n        return getPreference(\"loading\").equals(\"true\") && !inVAJava() && fLoading;\r\n    }\r\n\r\n    private static File getPreferencesFile() {\r\n        String home = System.getProperty(\"user.home\");\r\n        return new File(home, \"junit.properties\");\r\n    }\r\n\r\n    private static void readPreferences() {\r\n        InputStream is = null;\r\n        try {\r\n            is = new FileInputStream(getPreferencesFile());\r\n            setPreferences(new Properties(getPreferences()));\r\n            getPreferences().load(is);\r\n        } catch (IOException e) {\r\n            try {\r\n                if (is != null)\r\n                    is.close();\r\n            } catch (IOException e1) {\r\n            }\r\n        }\r\n    }\r\n\r\n    public static String getPreference(String key) {\r\n        return getPreferences().getProperty(key);\r\n    }\r\n\r\n    public static int getPreference(String key, int dflt) {\r\n        String value = getPreference(key);\r\n        int intValue = dflt;\r\n        if (value == null)\r\n            return intValue;\r\n        try {\r\n            intValue = Integer.parseInt(value);\r\n        } catch (NumberFormatException ne) {\r\n        }\r\n        return intValue;\r\n    }\r\n\r\n    public static boolean inVAJava() {\r\n        try {\r\n            Class.forName(\"com.ibm.uvm.tools.DebugSupport\");\r\n        } catch (Exception e) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Returns a filtered stack trace\r\n     */\r\n    public static String getFilteredTrace(Throwable t) {\r\n        StringWriter stringWriter = new StringWriter();\r\n        PrintWriter writer = new PrintWriter(stringWriter);\r\n        t.printStackTrace(writer);\r\n        StringBuffer buffer = stringWriter.getBuffer();\r\n        String trace = buffer.toString();\r\n        return BaseTestRunner.getFilteredTrace(trace);\r\n    }\r\n\r\n    /**\r\n     * Filters stack frames from internal JUnit classes\r\n     */\r\n    public static String getFilteredTrace(String stack) {\r\n        if (showStackRaw())\r\n            return stack;\r\n        StringWriter sw = new StringWriter();\r\n        PrintWriter pw = new PrintWriter(sw);\r\n        StringReader sr = new StringReader(stack);\r\n        BufferedReader br = new BufferedReader(sr);\r\n        String line;\r\n        try {\r\n            while ((line = br.readLine()) != null) {\r\n                if (!filterLine(line))\r\n                    pw.println(line);\r\n            }\r\n        } catch (Exception IOException) {\r\n            // return the stack unfiltered\r\n            return stack;\r\n        }\r\n        return sw.toString();\r\n    }\r\n\r\n    protected static boolean showStackRaw() {\r\n        return !getPreference(\"filterstack\").equals(\"true\") || fgFilterStack == false;\r\n    }\r\n\r\n    static boolean filterLine(String line) {\r\n        String[] patterns = new String[] { \"junit.framework.TestCase\", \"junit.framework.TestResult\", \"junit.framework.TestSuite\", // don't filter AssertionFailure\r\n        \"junit.framework.Assert.\", \"junit.swingui.TestRunner\", \"junit.awtui.TestRunner\", \"junit.textui.TestRunner\", \"java.lang.reflect.Method.invoke(\" };\r\n        for (int i = 0; i < patterns.length; i++) {\r\n            if (line.indexOf(patterns[i]) > 0)\r\n                return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    static {\r\n        fgMaxMessageLength = getPreference(\"maxmessage\", fgMaxMessageLength);\r\n    }\r\n}",
  "initializerCode": "static {\r\n    fgMaxMessageLength = getPreference(\"maxmessage\", fgMaxMessageLength);\r\n}",
  "subClasses": []
}