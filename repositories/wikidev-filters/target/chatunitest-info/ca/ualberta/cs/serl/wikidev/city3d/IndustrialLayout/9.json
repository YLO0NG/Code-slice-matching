{
  "className": "IndustrialLayout",
  "methodName": "prepareToWriteCitySnapshots",
  "brief": "public void prepareToWriteCitySnapshots(Timestamp start, Timestamp end){}",
  "methodSignature": "prepareToWriteCitySnapshots(Timestamp, Timestamp)",
  "sourceCode": "public void prepareToWriteCitySnapshots(Timestamp start, Timestamp end) {\n\t\tTimestamp firstWeek = new Timestamp(start.getTime()+DataManager.WEEK_INTERVAL_IN_MILLIS);\n\t\tfor(long l=firstWeek.getTime(); l<end.getTime()+DataManager.WEEK_INTERVAL_IN_MILLIS; l+=DataManager.WEEK_INTERVAL_IN_MILLIS) {\n\t\t\tif(l>end.getTime()) {\n\t\t\t\tl = end.getTime();\n\t\t\t}\n\t\t\tTimestamp nextWeek = new Timestamp(l);\n\t\t\tfor(CityBlock block : cityBlocks) {\n\t\t\t\tfor(IArtifact artifact : block.getArtifacts().keySet()) {\n\t\t\t\t\tString type = \"\";\n\t\t\t\t\tint height = 0;\n\t\t\t\t\tHashMap<User, Double> userContribution = null;\n\t\t\t\t\tint id=0;\n\t\t\t\t\tString url = \"\";\n\t\t\t\t\tUser lastEditor = null;\n\t\t\t\t\tTimestamp created = null;\n\t\t\t\t\tTimestamp lastModified = null; \n\t\t\t\t\tif (artifact instanceof SVNFile) {\n\t\t\t\t\t\tSVNFile file = (SVNFile)artifact;\n\t\t\t\t\t\ttype += file.getType();\n\t\t\t\t\t\theight = getChangesForFileBeforeDate(file, nextWeek);\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\turl = URLprefix+DataManager.getProjectByID(projectid).getProjectName()+\"_File:\"+file.getName();\n\t\t\t\t\t\t} catch (SQLException e) {\n\t\t\t\t\t\t\t// TODO Auto-generated catch block\n\t\t\t\t\t\t\te.printStackTrace();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tuserContribution = getUserContributionBeforeDate(file, nextWeek, getUsers(projectid));\n\t\t\t\t\t\tthis.setTimeCreatedBeforeDate(file, nextWeek);\n\t\t\t\t\t\tthis.setLastEditorAndTimeLastModifiedBeforeDate(file, nextWeek);\n\t\t\t\t\t\t\n\t\t\t\t\t\tlastEditor = file.getLastEditor();\n\t\t\t\t\t\tcreated = file.getCreated();\n\t\t\t\t\t\tlastModified = file.getLastModified();\n\t\t\t\t\t}\n\t\t\t\t\tArrayList<UserData> userData = new ArrayList<UserData>();\n\t\t\t\t\tfor(User user : userContribution.keySet()) {\n\t\t\t\t\t\tuserData.add(new UserData(user.getUserName(), user.getColor().getRed(), user.getColor().getGreen(), user.getColor().getBlue(), userContribution.get(user), nextWeek, IndustrialLayout.CITY_TYPE));\n\t\t\t\t\t}\n\t\t\t\t\tFileBuildingData building = new FileBuildingData(type, nextWeek, height, block.getIndex().x, block.getIndex().y, block.getArtifacts().get(artifact), url, projectid, userData, lastEditor, created, lastModified);\n\t\t\t\t\tSystem.out.println(\"Writing \"+building.getUrl());\n\t\t\t\t\ttry {\n\t\t\t\t\t\tDataManager.writeFilesBuildingData(building);\n\t\t\t\t\t} catch (SQLException e) {\n\t\t\t\t\t\t// TODO Auto-generated catch block\n\t\t\t\t\t\te.printStackTrace();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}",
  "useField": true,
  "isConstructor": false,
  "isGetSet": false,
  "isPublic": true,
  "isBoolean": false,
  "isAbstract": false,
  "parameters": [
    "Timestamp",
    "Timestamp"
  ],
  "dependentMethods": {
    "java.sql.Timestamp": [
      "getTime()"
    ],
    "java.util.HashMap": [
      "get(Object)",
      "keySet()"
    ],
    "ca.ualberta.cs.serl.wikidev.city3d.CityBlock": [
      "getArtifacts()",
      "getIndex()"
    ],
    "ca.ualberta.cs.serl.wikidev.artifacts.SVNFile": [
      "getName()",
      "getType()"
    ],
    "ca.ualberta.cs.serl.wikidev.city3d.IndustrialLayout": [
      "getUserContributionBeforeDate(SVNFile, Timestamp, User>)",
      "setTimeCreatedBeforeDate(SVNFile, Timestamp)",
      "setLastEditorAndTimeLastModifiedBeforeDate(SVNFile, Timestamp)",
      "getChangesForFileBeforeDate(SVNFile, Timestamp)"
    ],
    "ca.ualberta.cs.serl.wikidev.Project": [
      "getProjectName()"
    ],
    "ca.ualberta.cs.serl.wikidev.DataManager": [
      "writeFilesBuildingData(FileBuildingData)",
      "getProjectByID(int)"
    ],
    "java.lang.Throwable": [
      "printStackTrace()"
    ],
    "ca.ualberta.cs.serl.wikidev.city3d.Layout": [
      "getUsers(int)"
    ],
    "ca.ualberta.cs.serl.wikidev.artifacts.IArtifact": [
      "getCreated()",
      "getLastEditor()",
      "getLastModified()"
    ],
    "java.util.ArrayList": [
      "add(E)"
    ],
    "ca.ualberta.cs.serl.wikidev.User": [
      "getColor()",
      "getUserName()"
    ],
    "java.awt.Color": [
      "getGreen()",
      "getBlue()",
      "getRed()"
    ],
    "java.io.PrintStream": [
      "println(String)"
    ],
    "ca.ualberta.cs.serl.wikidev.city3d.animation.BuildingData": [
      "getUrl()"
    ]
  },
  "full_method_info": "public void prepareToWriteCitySnapshots(Timestamp start, Timestamp end) {\n    Timestamp firstWeek = new Timestamp(start.getTime() + DataManager.WEEK_INTERVAL_IN_MILLIS);\n    for (long l = firstWeek.getTime(); l < end.getTime() + DataManager.WEEK_INTERVAL_IN_MILLIS; l += DataManager.WEEK_INTERVAL_IN_MILLIS) {\n        if (l > end.getTime()) {\n            l = end.getTime();\n        }\n        Timestamp nextWeek = new Timestamp(l);\n        for (CityBlock block : cityBlocks) {\n            for (IArtifact artifact : block.getArtifacts().keySet()) {\n                String type = \"\";\n                int height = 0;\n                HashMap<User, Double> userContribution = null;\n                int id = 0;\n                String url = \"\";\n                User lastEditor = null;\n                Timestamp created = null;\n                Timestamp lastModified = null;\n                if (artifact instanceof SVNFile) {\n                    SVNFile file = (SVNFile) artifact;\n                    type += file.getType();\n                    height = getChangesForFileBeforeDate(file, nextWeek);\n                    try {\n                        url = URLprefix + DataManager.getProjectByID(projectid).getProjectName() + \"_File:\" + file.getName();\n                    } catch (SQLException e) {\n                        // TODO Auto-generated catch block\n                        e.printStackTrace();\n                    }\n                    userContribution = getUserContributionBeforeDate(file, nextWeek, getUsers(projectid));\n                    this.setTimeCreatedBeforeDate(file, nextWeek);\n                    this.setLastEditorAndTimeLastModifiedBeforeDate(file, nextWeek);\n                    lastEditor = file.getLastEditor();\n                    created = file.getCreated();\n                    lastModified = file.getLastModified();\n                }\n                ArrayList<UserData> userData = new ArrayList<UserData>();\n                for (User user : userContribution.keySet()) {\n                    userData.add(new UserData(user.getUserName(), user.getColor().getRed(), user.getColor().getGreen(), user.getColor().getBlue(), userContribution.get(user), nextWeek, IndustrialLayout.CITY_TYPE));\n                }\n                FileBuildingData building = new FileBuildingData(type, nextWeek, height, block.getIndex().x, block.getIndex().y, block.getArtifacts().get(artifact), url, projectid, userData, lastEditor, created, lastModified);\n                System.out.println(\"Writing \" + building.getUrl());\n                try {\n                    DataManager.writeFilesBuildingData(building);\n                } catch (SQLException e) {\n                    // TODO Auto-generated catch block\n                    e.printStackTrace();\n                }\n            }\n        }\n    }\n}",
  "method_comment": "",
  "method_annotation": ""
}