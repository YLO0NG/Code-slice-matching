{
  "fullClassName": "ca.ualberta.cs.serl.wikidev.ClusteringMain",
  "className": "ClusteringMain",
  "index": 32,
  "modifier": "[public ]",
  "extend": "[]",
  "implement": "[]",
  "packageName": "ca.ualberta.cs.serl.wikidev",
  "packageDeclaration": "package ca.ualberta.cs.serl.wikidev;",
  "classSignature": "public class ClusteringMain",
  "hasConstructor": false,
  "isPublic": true,
  "isInterface": false,
  "isAbstract": false,
  "imports": [
    "import java.sql.Timestamp;",
    "import java.util.ArrayList;",
    "import ca.ualberta.cs.serl.wikidev.artifacts.IArtifact;",
    "import ca.ualberta.cs.serl.wikidev.clustering.Cluster;",
    "import ca.ualberta.cs.serl.wikidev.clustering.ClusterPoint;",
    "import ca.ualberta.cs.serl.wikidev.clustering.Clustering;",
    "import ca.ualberta.cs.serl.wikidev.clustering.MultidimensionalScaling;",
    "import ca.ualberta.cs.serl.wikidev.clustering.SammonsProjection;"
  ],
  "fields": [],
  "superClasses": [],
  "implementedTypes": [],
  "methodSigs": {
    "main(String[])": "0"
  },
  "methodsBrief": [
    "public static void main(String[] args){}"
  ],
  "constructorSigs": [],
  "constructorBrief": [],
  "getterSetterSigs": [],
  "getterSetterBrief": [],
  "constructorDeps": {},
  "compilationUnitCode": "package ca.ualberta.cs.serl.wikidev;\n\nimport java.sql.Timestamp;\nimport java.util.ArrayList;\nimport ca.ualberta.cs.serl.wikidev.artifacts.IArtifact;\nimport ca.ualberta.cs.serl.wikidev.clustering.Cluster;\nimport ca.ualberta.cs.serl.wikidev.clustering.ClusterPoint;\nimport ca.ualberta.cs.serl.wikidev.clustering.Clustering;\nimport ca.ualberta.cs.serl.wikidev.clustering.MultidimensionalScaling;\nimport ca.ualberta.cs.serl.wikidev.clustering.SammonsProjection;\n\npublic class ClusteringMain {\n\n    /**\n     * @param args\n     */\n    public static void main(String[] args) {\n        try {\n            String[] args2 = { \"jdbc:mysql://hypatia.cs.ualberta.ca/wikidev_ucosp\", \"fokaefs\", \"filimon9786#7@gr\", \"2009-09-01 00:00:00\", \"2010-01-01 00:00:00\", \"1\", \"weekly\", \"-lb\", \"0.05\", \"-ub\", \"0.95\", \"-i\", \"0.05\" };\n            InvocationParser ip = new InvocationParser();\n            ip.parseArgs(args2);\n            String databaseName = ip.getDatabaseName();\n            String username = ip.getUsername();\n            String password = ip.getPassword();\n            DataManager.openTheConnection(username, password, databaseName);\n            String fromdate = ip.getFromdate();\n            String todate = ip.getTodate();\n            // String fromdate = DataManager.getTheEarlierstTimeOfActivity().toString();\n            // String todate = DataManager.getTheLatestTimeOfActivity().toString();\n            // String fromdate = \"2009-09-01 00:00:00\";\n            // String todate = \"2010-01-01 00:00:00\";\n            int project = ip.getProject();\n            String window = ip.getWindow();\n            double lowerBound = ip.getLowerBound();\n            double upperBound = ip.getUpperBound();\n            double interval = ip.getInterval();\n            String week = \"week\";\n            Timestamp firstWeek = new Timestamp(Timestamp.valueOf(fromdate).getTime() + DataManager.WEEK_INTERVAL_IN_MILLIS);\n            Timestamp previousWeek = Timestamp.valueOf(fromdate);\n            for (long l = firstWeek.getTime(); l < Timestamp.valueOf(todate).getTime() + DataManager.WEEK_INTERVAL_IN_MILLIS; l += DataManager.WEEK_INTERVAL_IN_MILLIS) {\n                if (l > Timestamp.valueOf(todate).getTime()) {\n                    l = Timestamp.valueOf(todate).getTime();\n                }\n                Timestamp nextWeek = new Timestamp(l);\n                System.out.println(\"From \" + previousWeek.toString() + \" to \" + nextWeek.toString());\n                ArrayList<Cluster> totalClusters = new ArrayList<Cluster>();\n                ArrayList<IArtifact> newArtifacts = DataManager.getArtifactsBetweenDates(previousWeek.toString(), nextWeek.toString(), project);\n                RelationshipMiner rm = new RelationshipMiner(newArtifacts);\n                rm.getRelationships();\n                double[][] distanceMatrix = rm.getDistanceMatrix();\n                // System.out.println(\"Clustering start\");\n                for (double threshold = lowerBound; threshold <= upperBound; threshold += interval) {\n                    double[][] coords = new double[distanceMatrix.length][distanceMatrix.length];\n                    Clustering clustering = Clustering.getInstance(0, distanceMatrix, threshold);\n                    ArrayList<Cluster> clusters = clustering.clustering(newArtifacts);\n                    if (clusters != null) {\n                        ArrayList<Cluster> finalClusters = new ArrayList<Cluster>();\n                        for (Cluster cluster : clusters) {\n                            if (cluster.getArtifacts().size() > 1) {\n                                if (!totalClusters.contains(cluster)) {\n                                    finalClusters.add(cluster);\n                                    totalClusters.add(cluster);\n                                }\n                            }\n                        }\n                        if (distanceMatrix.length > 0 && !finalClusters.isEmpty()) {\n                            MultidimensionalScaling mds = new MultidimensionalScaling(distanceMatrix);\n                            double[][] mdsCoords = mds.cMDS();\n                            SammonsProjection sammon = new SammonsProjection(mdsCoords, 2, 1000);\n                            sammon.CreateMapping();\n                            coords = sammon.getProjection();\n                        }\n                        int index = 1;\n                        int clustered = 0;\n                        for (Cluster cluster : finalClusters) {\n                            for (IArtifact artifact : cluster.getArtifacts()) {\n                                int j = newArtifacts.indexOf(artifact);\n                                cluster.addCoordinate(artifact, new ClusterPoint(coords[j][0], coords[j][1]));\n                            }\n                            clustered += cluster.getArtifacts().size();\n                            cluster.setUsersAndWords();\n                            cluster.setIndex(index);\n                            cluster.setFromdate(Timestamp.valueOf(fromdate));\n                            cluster.setTodate(Timestamp.valueOf(todate));\n                            cluster.setProject(project);\n                            cluster.setCluster_set_name(window);\n                            cluster.setThreshold(threshold);\n                            index++;\n                            // System.out.println(\"Writing cluster\");\n                            DataManager.writeCluster(cluster);\n                        }\n                        DataManager.writeClusterPerProject(project, clustered, newArtifacts.size(), previousWeek.toString(), nextWeek.toString(), window, threshold);\n                        // printClusters(finalClusters, week+threshold);\n                    }\n                    // System.out.println(\"Clustering end\");\n                    // rm.printResults(project);\n                    // System.out.println(\"Finish!!!!\");\n                }\n                System.out.println(\"Success!!!\");\n                previousWeek = nextWeek;\n            }\n            DataManager.closeTheConnection();\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n}\n",
  "classDeclarationCode": "public class ClusteringMain {\n\n    /**\n     * @param args\n     */\n    public static void main(String[] args) {\n        try {\n            String[] args2 = { \"jdbc:mysql://hypatia.cs.ualberta.ca/wikidev_ucosp\", \"fokaefs\", \"filimon9786#7@gr\", \"2009-09-01 00:00:00\", \"2010-01-01 00:00:00\", \"1\", \"weekly\", \"-lb\", \"0.05\", \"-ub\", \"0.95\", \"-i\", \"0.05\" };\n            InvocationParser ip = new InvocationParser();\n            ip.parseArgs(args2);\n            String databaseName = ip.getDatabaseName();\n            String username = ip.getUsername();\n            String password = ip.getPassword();\n            DataManager.openTheConnection(username, password, databaseName);\n            String fromdate = ip.getFromdate();\n            String todate = ip.getTodate();\n            // String fromdate = DataManager.getTheEarlierstTimeOfActivity().toString();\n            // String todate = DataManager.getTheLatestTimeOfActivity().toString();\n            // String fromdate = \"2009-09-01 00:00:00\";\n            // String todate = \"2010-01-01 00:00:00\";\n            int project = ip.getProject();\n            String window = ip.getWindow();\n            double lowerBound = ip.getLowerBound();\n            double upperBound = ip.getUpperBound();\n            double interval = ip.getInterval();\n            String week = \"week\";\n            Timestamp firstWeek = new Timestamp(Timestamp.valueOf(fromdate).getTime() + DataManager.WEEK_INTERVAL_IN_MILLIS);\n            Timestamp previousWeek = Timestamp.valueOf(fromdate);\n            for (long l = firstWeek.getTime(); l < Timestamp.valueOf(todate).getTime() + DataManager.WEEK_INTERVAL_IN_MILLIS; l += DataManager.WEEK_INTERVAL_IN_MILLIS) {\n                if (l > Timestamp.valueOf(todate).getTime()) {\n                    l = Timestamp.valueOf(todate).getTime();\n                }\n                Timestamp nextWeek = new Timestamp(l);\n                System.out.println(\"From \" + previousWeek.toString() + \" to \" + nextWeek.toString());\n                ArrayList<Cluster> totalClusters = new ArrayList<Cluster>();\n                ArrayList<IArtifact> newArtifacts = DataManager.getArtifactsBetweenDates(previousWeek.toString(), nextWeek.toString(), project);\n                RelationshipMiner rm = new RelationshipMiner(newArtifacts);\n                rm.getRelationships();\n                double[][] distanceMatrix = rm.getDistanceMatrix();\n                // System.out.println(\"Clustering start\");\n                for (double threshold = lowerBound; threshold <= upperBound; threshold += interval) {\n                    double[][] coords = new double[distanceMatrix.length][distanceMatrix.length];\n                    Clustering clustering = Clustering.getInstance(0, distanceMatrix, threshold);\n                    ArrayList<Cluster> clusters = clustering.clustering(newArtifacts);\n                    if (clusters != null) {\n                        ArrayList<Cluster> finalClusters = new ArrayList<Cluster>();\n                        for (Cluster cluster : clusters) {\n                            if (cluster.getArtifacts().size() > 1) {\n                                if (!totalClusters.contains(cluster)) {\n                                    finalClusters.add(cluster);\n                                    totalClusters.add(cluster);\n                                }\n                            }\n                        }\n                        if (distanceMatrix.length > 0 && !finalClusters.isEmpty()) {\n                            MultidimensionalScaling mds = new MultidimensionalScaling(distanceMatrix);\n                            double[][] mdsCoords = mds.cMDS();\n                            SammonsProjection sammon = new SammonsProjection(mdsCoords, 2, 1000);\n                            sammon.CreateMapping();\n                            coords = sammon.getProjection();\n                        }\n                        int index = 1;\n                        int clustered = 0;\n                        for (Cluster cluster : finalClusters) {\n                            for (IArtifact artifact : cluster.getArtifacts()) {\n                                int j = newArtifacts.indexOf(artifact);\n                                cluster.addCoordinate(artifact, new ClusterPoint(coords[j][0], coords[j][1]));\n                            }\n                            clustered += cluster.getArtifacts().size();\n                            cluster.setUsersAndWords();\n                            cluster.setIndex(index);\n                            cluster.setFromdate(Timestamp.valueOf(fromdate));\n                            cluster.setTodate(Timestamp.valueOf(todate));\n                            cluster.setProject(project);\n                            cluster.setCluster_set_name(window);\n                            cluster.setThreshold(threshold);\n                            index++;\n                            // System.out.println(\"Writing cluster\");\n                            DataManager.writeCluster(cluster);\n                        }\n                        DataManager.writeClusterPerProject(project, clustered, newArtifacts.size(), previousWeek.toString(), nextWeek.toString(), window, threshold);\n                        // printClusters(finalClusters, week+threshold);\n                    }\n                    // System.out.println(\"Clustering end\");\n                    // rm.printResults(project);\n                    // System.out.println(\"Finish!!!!\");\n                }\n                System.out.println(\"Success!!!\");\n                previousWeek = nextWeek;\n            }\n            DataManager.closeTheConnection();\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n}",
  "subClasses": []
}