{
  "fullClassName": "CH.ifa.draw.standard.ConnectionHandle",
  "className": "ConnectionHandle",
  "index": 116,
  "modifier": "[public ]",
  "extend": "[LocatorHandle]",
  "implement": "[]",
  "packageName": "CH.ifa.draw.standard",
  "packageDeclaration": "package CH.ifa.draw.standard;",
  "classSignature": "public  class ConnectionHandle",
  "hasConstructor": true,
  "isPublic": true,
  "isInterface": false,
  "isAbstract": false,
  "imports": [
    "import java.awt.*;",
    "import CH.ifa.draw.framework.*;",
    "import CH.ifa.draw.util.Geom;"
  ],
  "fields": [
    "private ConnectionFigure fConnection;",
    "private ConnectionFigure fPrototype;",
    "private Figure fTarget = null;"
  ],
  "superClasses": [
    "LocatorHandle"
  ],
  "implementedTypes": [],
  "methodSigs": {
    "invokeStart(int, int, DrawingView)": "0",
    "invokeStep(int, int, int, int, DrawingView)": "1",
    "invokeEnd(int, int, int, int, DrawingView)": "2",
    "startConnector()": "3",
    "createConnection()": "4",
    "findConnectionTarget(int, int, Drawing)": "5",
    "findConnectableFigure(int, int, Drawing)": "6",
    "findConnector(int, int, Figure)": "7",
    "draw(Graphics)": "8",
    "ConnectionHandle(Figure, Locator, ConnectionFigure)": "9"
  },
  "methodsBrief": [
    "public void invokeStart(int  x, int  y, DrawingView view){}",
    "public void invokeStep (int x, int y, int anchorX, int anchorY, DrawingView view){}",
    "public void invokeEnd(int x, int y, int anchorX, int anchorY, DrawingView view){}",
    "private Connector startConnector(){}",
    "protected ConnectionFigure createConnection(){}",
    "protected Connector findConnectionTarget(int x, int y, Drawing drawing){}",
    "private Figure findConnectableFigure(int x, int y, Drawing drawing){}",
    "protected Connector findConnector(int x, int y, Figure f){}",
    "public void draw(Graphics g){}",
    "public ConnectionHandle(Figure owner, Locator l, ConnectionFigure prototype){}"
  ],
  "constructorSigs": [
    "ConnectionHandle(Figure, Locator, ConnectionFigure)"
  ],
  "constructorBrief": [
    "public ConnectionHandle(Figure owner, Locator l, ConnectionFigure prototype){}"
  ],
  "getterSetterSigs": [],
  "getterSetterBrief": [],
  "constructorDeps": {
    "CH.ifa.draw.framework.Figure": [],
    "CH.ifa.draw.framework.Locator": [],
    "CH.ifa.draw.framework.ConnectionFigure": []
  },
  "compilationUnitCode": "/*\n * @(#)ConnectionHandle.java 5.2\n *\n */\npackage CH.ifa.draw.standard;\n\nimport java.awt.*;\nimport CH.ifa.draw.framework.*;\nimport CH.ifa.draw.util.Geom;\n\n/**\n * A handle to connect figures.\n * The connection object to be created is specified by a prototype.\n * <hr>\n * <b>Design Patterns</b><P>\n * <img src=\"images/red-ball-small.gif\" width=6 height=6 alt=\" o \">\n * <b><a href=../pattlets/sld029.htm>Prototype</a></b><br>\n * ConnectionHandle creates the connection by cloning a prototype.\n * <hr>\n *\n * @see ConnectionFigure\n * @see Object#clone\n */\npublic class ConnectionHandle extends LocatorHandle {\n\n    /**\n     * the currently created connection\n     */\n    private ConnectionFigure fConnection;\n\n    /**\n     * the prototype of the connection to be created\n     */\n    private ConnectionFigure fPrototype;\n\n    /**\n     * the current target\n     */\n    private Figure fTarget = null;\n\n    public ConnectionHandle(Figure owner, Locator l, ConnectionFigure prototype) {\n        super(owner, l);\n        fPrototype = prototype;\n    }\n\n    /**\n     * Creates the connection\n     */\n    public void invokeStart(int x, int y, DrawingView view) {\n        fConnection = createConnection();\n        Point p = locate();\n        fConnection.startPoint(p.x, p.y);\n        fConnection.endPoint(p.x, p.y);\n        view.drawing().add(fConnection);\n    }\n\n    /**\n     * Tracks the connection.\n     */\n    public void invokeStep(int x, int y, int anchorX, int anchorY, DrawingView view) {\n        Point p = new Point(x, y);\n        Figure f = findConnectableFigure(x, y, view.drawing());\n        // track the figure containing the mouse\n        if (f != fTarget) {\n            if (fTarget != null)\n                fTarget.connectorVisibility(false);\n            fTarget = f;\n            if (fTarget != null)\n                fTarget.connectorVisibility(true);\n        }\n        Connector target = findConnectionTarget(p.x, p.y, view.drawing());\n        if (target != null)\n            p = Geom.center(target.displayBox());\n        fConnection.endPoint(p.x, p.y);\n    }\n\n    /**\n     * Connects the figures if the mouse is released over another\n     * figure.\n     */\n    public void invokeEnd(int x, int y, int anchorX, int anchorY, DrawingView view) {\n        Connector target = findConnectionTarget(x, y, view.drawing());\n        if (target != null) {\n            fConnection.connectStart(startConnector());\n            fConnection.connectEnd(target);\n            fConnection.updateConnection();\n        } else\n            view.drawing().remove(fConnection);\n        fConnection = null;\n        if (fTarget != null) {\n            fTarget.connectorVisibility(false);\n            fTarget = null;\n        }\n    }\n\n    private Connector startConnector() {\n        Point p = locate();\n        return owner().connectorAt(p.x, p.y);\n    }\n\n    /**\n     * Creates the ConnectionFigure. By default the figure prototype is\n     * cloned.\n     */\n    protected ConnectionFigure createConnection() {\n        return (ConnectionFigure) fPrototype.clone();\n    }\n\n    /**\n     * Finds a connection end figure.\n     */\n    protected Connector findConnectionTarget(int x, int y, Drawing drawing) {\n        Figure target = findConnectableFigure(x, y, drawing);\n        if ((target != null) && target.canConnect() && !target.includes(owner()) && fConnection.canConnect(owner(), target)) {\n            return findConnector(x, y, target);\n        }\n        return null;\n    }\n\n    private Figure findConnectableFigure(int x, int y, Drawing drawing) {\n        FigureEnumeration k = drawing.figuresReverse();\n        while (k.hasMoreElements()) {\n            Figure figure = k.nextFigure();\n            if (!figure.includes(fConnection) && figure.canConnect()) {\n                if (figure.containsPoint(x, y))\n                    return figure;\n            }\n        }\n        return null;\n    }\n\n    protected Connector findConnector(int x, int y, Figure f) {\n        return f.connectorAt(x, y);\n    }\n\n    /**\n     * Draws the connection handle, by default the outline of a\n     * blue circle.\n     */\n    public void draw(Graphics g) {\n        Rectangle r = displayBox();\n        g.setColor(Color.blue);\n        g.drawOval(r.x, r.y, r.width, r.height);\n    }\n}\n",
  "classDeclarationCode": "/**\n * A handle to connect figures.\n * The connection object to be created is specified by a prototype.\n * <hr>\n * <b>Design Patterns</b><P>\n * <img src=\"images/red-ball-small.gif\" width=6 height=6 alt=\" o \">\n * <b><a href=../pattlets/sld029.htm>Prototype</a></b><br>\n * ConnectionHandle creates the connection by cloning a prototype.\n * <hr>\n *\n * @see ConnectionFigure\n * @see Object#clone\n */\npublic class ConnectionHandle extends LocatorHandle {\n\n    /**\n     * the currently created connection\n     */\n    private ConnectionFigure fConnection;\n\n    /**\n     * the prototype of the connection to be created\n     */\n    private ConnectionFigure fPrototype;\n\n    /**\n     * the current target\n     */\n    private Figure fTarget = null;\n\n    public ConnectionHandle(Figure owner, Locator l, ConnectionFigure prototype) {\n        super(owner, l);\n        fPrototype = prototype;\n    }\n\n    /**\n     * Creates the connection\n     */\n    public void invokeStart(int x, int y, DrawingView view) {\n        fConnection = createConnection();\n        Point p = locate();\n        fConnection.startPoint(p.x, p.y);\n        fConnection.endPoint(p.x, p.y);\n        view.drawing().add(fConnection);\n    }\n\n    /**\n     * Tracks the connection.\n     */\n    public void invokeStep(int x, int y, int anchorX, int anchorY, DrawingView view) {\n        Point p = new Point(x, y);\n        Figure f = findConnectableFigure(x, y, view.drawing());\n        // track the figure containing the mouse\n        if (f != fTarget) {\n            if (fTarget != null)\n                fTarget.connectorVisibility(false);\n            fTarget = f;\n            if (fTarget != null)\n                fTarget.connectorVisibility(true);\n        }\n        Connector target = findConnectionTarget(p.x, p.y, view.drawing());\n        if (target != null)\n            p = Geom.center(target.displayBox());\n        fConnection.endPoint(p.x, p.y);\n    }\n\n    /**\n     * Connects the figures if the mouse is released over another\n     * figure.\n     */\n    public void invokeEnd(int x, int y, int anchorX, int anchorY, DrawingView view) {\n        Connector target = findConnectionTarget(x, y, view.drawing());\n        if (target != null) {\n            fConnection.connectStart(startConnector());\n            fConnection.connectEnd(target);\n            fConnection.updateConnection();\n        } else\n            view.drawing().remove(fConnection);\n        fConnection = null;\n        if (fTarget != null) {\n            fTarget.connectorVisibility(false);\n            fTarget = null;\n        }\n    }\n\n    private Connector startConnector() {\n        Point p = locate();\n        return owner().connectorAt(p.x, p.y);\n    }\n\n    /**\n     * Creates the ConnectionFigure. By default the figure prototype is\n     * cloned.\n     */\n    protected ConnectionFigure createConnection() {\n        return (ConnectionFigure) fPrototype.clone();\n    }\n\n    /**\n     * Finds a connection end figure.\n     */\n    protected Connector findConnectionTarget(int x, int y, Drawing drawing) {\n        Figure target = findConnectableFigure(x, y, drawing);\n        if ((target != null) && target.canConnect() && !target.includes(owner()) && fConnection.canConnect(owner(), target)) {\n            return findConnector(x, y, target);\n        }\n        return null;\n    }\n\n    private Figure findConnectableFigure(int x, int y, Drawing drawing) {\n        FigureEnumeration k = drawing.figuresReverse();\n        while (k.hasMoreElements()) {\n            Figure figure = k.nextFigure();\n            if (!figure.includes(fConnection) && figure.canConnect()) {\n                if (figure.containsPoint(x, y))\n                    return figure;\n            }\n        }\n        return null;\n    }\n\n    protected Connector findConnector(int x, int y, Figure f) {\n        return f.connectorAt(x, y);\n    }\n\n    /**\n     * Draws the connection handle, by default the outline of a\n     * blue circle.\n     */\n    public void draw(Graphics g) {\n        Rectangle r = displayBox();\n        g.setColor(Color.blue);\n        g.drawOval(r.x, r.y, r.width, r.height);\n    }\n}",
  "subClasses": []
}